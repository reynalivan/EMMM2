
> emmm2@0.1.0 test E:\Dev\EMMM2NEW
> vitest "src/features/details/" "--reporter=verbose"


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90mE:/Dev/EMMM2NEW[39m

 [32mâœ“[39m src/features/details/previewPanelUtils.test.ts[2m > [22mpreviewPanelUtils[2m > [22mloads current and adjacent gallery images including wrap-around[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/details/previewPanelUtils.test.ts[2m > [22mpreviewPanelUtils[2m > [22mvalidates ini draft values[32m 0[2mms[22m[39m
 [32mâœ“[39m src/features/details/previewPanelUtils.test.ts[2m > [22mpreviewPanelUtils[2m > [22mbuilds key bind sections with editable key/back and assignments[32m 2[2mms[22m[39m
 [32mâœ“[39m src/features/details/previewPanelUtils.test.ts[2m > [22mpreviewPanelUtils[2m > [22mcreates write payload grouped by file and reports field errors[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/details/previewPanelUtils.test.ts[2m > [22mpreviewPanelUtils[2m > [22mbuilds variable summaries with ranges and occurrences[32m 9[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould render keybind tab when activeTab is keybind[32m 40[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould render information tab when activeTab is information[32m 14[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould call onTabChange when switching tabs[32m 16[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould disable save button when not dirty[32m 4[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould enable save button when editor is dirty[32m 5[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould disable save button when isSaving is true[32m 4[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mfetches mod info when folder path is provided[32m 79[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould display empty state when no images available[32m 23[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould display image counter showing current index and total[32m 7[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould enable paste button when canEdit is true[32m 7[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould disable context menu items when canEdit is false[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould have import thumbnail option in context menu[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould handle multiple images with lazy loading optimization[32m 16[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould show prev/next buttons only when multiple images exist[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould call onSave when save button is clicked[32m 18[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould call onDiscard when discard button is clicked[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mfetches ini files list[32m 75[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould call onPrev when prev button is clicked (multiple images)[32m 4[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould call onNext when next button is clicked (multiple images)[32m 12[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould handle broken image paths gracefully[32m 16[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould show loading placeholder during image fetch[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould disable context menu items when isMutating is true[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould call onRequestRemoveCurrent when delete option selected[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould call onRequestClearAll when clear all option selected[32m 9[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/GallerySection.test.tsx[2m > [22mGallerySection[2m > [22mshould handle currentImageIndex out of bounds by clamping[32m 7[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould call onFieldChange when field input changes[32m 97[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould render section header with collapse toggle[32m 3[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould call onToggleSection when section header is clicked[32m 38[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould display variable summaries in information tab[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould render $active overview in information tab[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould render variable range information[32m 16[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould display field errors when present[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/components/IniEditorSection.test.tsx[2m > [22mIniEditorSection[2m > [22mshould show empty state when no keybind sections exist[32m 15[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mfetches ini document for selected file[32m 78[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mfetches all ini documents for the current folder[32m 75[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mfetches ordered preview images[32m 77[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mwrites ini line updates with mutation[32m 3[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22msaves preview image with object naming mutation[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mremoves one preview image with mutation[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mclears all preview images with mutation[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mmutation error is exposed to caller[32m 2[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mupdates mod info with mutation[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/details/hooks/usePreviewData.test.ts[2m > [22musePreviewData hooks[2m > [22mtracks the latest selected folder path for preview sync[32m 1[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould handle paste thumbnail flow when clipboard has image[32m 214[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould show unsaved modal when trying to change mod with unsaved editor changes[32m 9[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould display mod title and description from hook state[32m 24[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould toggle mod enabled state via checkbox[32m 32[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould show warning when trying to open folder without active path[32m 100[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould accept file input for thumbnail import[32m 8[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould discard editor changes when unsaved modal onDiscard is called[32m 13[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould save editor changes when unsaved modal onSave is called[32m 16[2mms[22m[39m
 [32mâœ“[39m src/features/details/PreviewPanel.test.tsx[2m > [22mPreviewPanel[2m > [22mshould display error toast when open_in_explorer fails[32m 15[2mms[22m[39m

<--- Last few GCs --->

[74800:000001FAFB289000]    59963 ms: Scavenge (interleaved) 8158.3 (8171.3) -> 8153.7 (8189.1) MB, pooled: 0 MB, 14.37 / 0.00 ms  (average mu = 0.254, current mu = 0.185) allocation failure; 
[74800:000001FAFB289000]    62281 ms: Mark-Compact (reduce) 8178.0 (8199.3) -> 8165.5 (8173.8) MB, pooled: 0 MB, 134.85 / 0.00 ms  (+ 1852.9 ms in 369 steps since start of marking, biggest step 6.9 ms, walltime since start of marking 2133 ms) (average mu 
FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory
----- Native stack trace -----

 1: 00007FF68D8D7F8F node::OnFatalError+1343
 2: 00007FF68E51B1E7 v8::Function::NewInstance+423
 3: 00007FF68E31BA97 v8::base::AddressSpaceReservation::AddressSpaceReservation+322071
 4: 00007FF68E31F7A4 v8::base::AddressSpaceReservation::AddressSpaceReservation+337700
 5: 00007FF68E32E73C v8::internal::StrongRootAllocatorBase::deallocate_impl+16604
 6: 00007FF68E32DF7B v8::internal::StrongRootAllocatorBase::deallocate_impl+14619
 7: 00007FF68F795D2D v8::base::UnsignedDivisionByConstant<unsigned __int64>+2791341
 8: 00007FF68E319560 v8::base::AddressSpaceReservation::AddressSpaceReservation+312544
 9: 00007FF68E39D0E9 v8::Unlocker::~Unlocker+9273
10: 00007FF68DF12E08 v8::String::Value::~Value+142680
11: 000001FAB7E7733A 
[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Unhandled Errors [49m[22m[31mâ¯â¯â¯â¯â¯â¯[39m
[31m[1m
Vitest caught 1 unhandled error during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.[22m[39m

[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Unhandled Error [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m
[31m[1mError[22m: [vitest-pool]: Worker forks emitted error.[39m
[90m [2mâ¯[22m EventEmitter.<anonymous> node_modules/.pnpm/vitest@4.0.18_jiti@2.6.1_jsdom@28.1.0_lightningcss@1.30.2/node_modules/vitest/dist/chunks/cli-api.B7PN_QUv.js:[2m8043:22[22m[39m
[90m [2mâ¯[22m EventEmitter.emit node:events:[2m508:28[22m[39m
[90m [2mâ¯[22m ChildProcess.emitUnexpectedExit node_modules/.pnpm/vitest@4.0.18_jiti@2.6.1_jsdom@28.1.0_lightningcss@1.30.2/node_modules/vitest/dist/chunks/cli-api.B7PN_QUv.js:[2m7610:22[22m[39m
[90m [2mâ¯[22m ChildProcess.emit node:events:[2m508:28[22m[39m
[90m [2mâ¯[22m Process.ChildProcess._handle.onexit node:internal/child_process:[2m294:12[22m[39m

[31m[1mCaused by: Error[22m: Worker exited unexpectedly[39m
[90m [2mâ¯[22m ChildProcess.emitUnexpectedExit node_modules/.pnpm/vitest@4.0.18_jiti@2.6.1_jsdom@28.1.0_lightningcss@1.30.2/node_modules/vitest/dist/chunks/cli-api.B7PN_QUv.js:[2m7609:33[22m[39m
[90m [2mâ¯[22m ChildProcess.emit node:events:[2m508:28[22m[39m
[90m [2mâ¯[22m Process.ChildProcess._handle.onexit node:internal/child_process:[2m294:12[22m[39m

[31mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[39m


[2m Test Files [22m [1m[32m5 passed[39m[22m[90m (6)[39m
[2m      Tests [22m [1m[32m57 passed[39m[22m[90m (76)[39m
[2m     Errors [22m [1m[31m1 error[39m[22m
[2m   Start at [22m 17:39:16
[2m   Duration [22m 63.00s[2m (transform 515ms, setup 603ms, import 1.93s, tests 1.37s, environment 3.41s)[22m

â€‰ELIFECYCLEâ€‰ Test failed. See above for more details.
